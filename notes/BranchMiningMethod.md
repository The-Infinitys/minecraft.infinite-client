## enabled

有効化された際、Baritoneが存在するかチェックし、なければ無効化。また、StateをInitializeとしてください。

## ティック処理　

まず、毎ティックでは、それぞれのStateに応じて処理を行います。

### Initialize

まず、周辺をスキャンし、チェストの位置を保存。また、初期開始地点と、その初期方角を保存します。そして、ブランチ開始地点を設定し、Scanに移ってください。

### Scan

Scanでは、既に決められた情報を元にして、ブランチをどこまで伸ばすかを決定します。
ブランチ開始地点を基準にして、プレイヤーが通る通路(2x1)とその周りを順番にスキャンしていき、以下に該当するまで距離を伸ばし続けます。

- 設定距離に到達する
- そのブロックの隣接ブロックが、水、または溶岩を含む
- そのブロックの隣接ブロックが空気で、かつ、その空気に繋がっている空気の合計が設定個数を上回る

スキャンが完了したら、距離を保存して、Branchに移ってください

### Branch

Branchでは、既に決められた条件をもとにして、MineBlockActionをインターフェイスを経由して順次追加していき、ブロックを採掘していってください。
もし設定で松明の設置が有効化されていれば、定期的に非鉱石ブロックに松明を設置してください。
決められた距離まで無事に掘れたら、その終端まで移動し、その後、Miningに移ってください。

### Mining

Miningでは、Branchによって出来た空洞の壁面部分(壁、天井、床)をスキャンし、露出している鉱石の位置を記録します。
そして、それらについて、ブランチの終端点からブランチの開始点へと直線上に並ぶようにソートし、順番にその地点に移動。露出している鉱石を全て、掘り、また露出した鉱石を掘るというのを、露出している鉱石がなくなるまで繰り返したあと、落ちた鉱石アイテムを回収してください。

順番に回収していき、全て済んだら、Checkに移ってください。

### Check

Checkでは、手に入ったアイテムを全て確認し、種類や個数などを、プレイヤーにログ経由で報告します。そして、その後、インベントリの空き容量が一定未満なら、Initializeフェーズで事前にスキャンしておいたチェストに、アイテムをしまうようにしてください。

全て済んだら、Nextに移ってください。

### Next

Nextでは、次のブランチへと移動を行います。初期方角を基準にして、設定方角(右か左)に、設定されていたブランチの間隔を開けて、次のブランチを作成するために、前のブランチの開始点と、次のブランチの開始点との間のブロックを全て掘り、次のブランチの位置を初期化してください。
これが終わったら、Scanに移ってください

## 備考

全てのプロセスについて、常に安全チェック(敵からダメージを受けていないか、通路中の想定外の場所に水や溶岩が出ていないか)をチェックし、安全を満たしていなければ、初期位置に移動したあとに機能を無効化してください。

## disabled

保存していた初期座標や方角などを、全て削除し、クリーンな状態にしてください。
